<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="module" src="../dist/rip.min.js"></script>
</head>
<body>
  <div id="app"></div>
  <script type="text/rip">
    { launch } = importRip!('../dist/ui.rip')

    params = new URLSearchParams(window.location.search)
    url = params.get('app') or 'index.json'
    res = await fetch(url)
    bundle = res.json!

    if bundle.css
      style = document.createElement('style')
      style.textContent = bundle.css
      document.head.appendChild style

    if bundle.data?.title
      document.title = bundle.data.title

    # Restore saved route (iframe hash is lost when parent reloads)
    savedRoute = localStorage.getItem('__rip_route')
    if savedRoute and savedRoute isnt '/'
      window.location.hash = savedRoute.slice(1)

    launch hash: true, persist: 'local', bundle: bundle
  </script>
</body>
</html>
